// -*- mode: c++ -*-

//
// project stormbreak
// author Maximilien M. Cura
//

#ifndef __STB_COMPONENTS
#define __STB_COMPONENTS

#include <STB/ECS/ECS>
#include <STB/Setup>

#include <Pewter/Glyph>

#include <STB/Physics>
#include <STB/Interactions>
#include <STB/Time>
#include <list>

namespace STB {
    struct GuiseComponent
    {
        static constexpr World::ComponentMask Mask = 2;
        typedef ECS::StandardComponentStorage<GuiseComponent> Storage;

        virtual void destroy () {}

        virtual pewter::Glyph guise () = 0;
    };

    struct StandardGuiseComponent
        : GuiseComponent
    {
        pewter::Glyph inner;

        virtual pewter::Glyph guise ();
        virtual void set_guise (pewter::Glyph);
    };

    struct PhysicsComponent
    {
        static constexpr World::ComponentMask = 3;
        typedef ECS::StandardComponentStorage<PhysicsComponent> Storage;

        virtual void destroy () {}

        virtual Physics::Weight get_weight ()   = 0;
        virtual Physics::Vector get_velocity () = 0;
        virtual Physics::Size get_size ()       = 0;
    };

    struct InteractionComponent
    {
        static constexpr World::ComponentMask = 4;
        typedef ECS::StandardComponentStorage<PhysicsComponent> Storage;

        virtual void destroy () {}
    };

    struct TimeComponent
    {
        static constexpr World::ComponentMask = 5;
        typedef ECS::StandardComponentStorage<PhysicsComponent> Storage;

        virtual void destroy () {}

        Time::Energy time_energy;
        Time::Energy time_energy_to_move;

        Time::Experience timeflow_state;
        // The debt owed to those who watch over time?
        Time::Experience timeflow_debt;
    };

    struct ContainerComponent
    {
        static constexpr World::ComponentMask = 6;
        typedef ECS::StandardComponentStorage<PhysicsComponent> Storage;

        virtual void destroy () {}

        std::list<Entity> contained_entities;
    };
}

#endif /* !@__STB_COMPONENTS */
